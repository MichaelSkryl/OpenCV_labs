# Лабораторная работа №3

Эта работа, помимо навыков, полученных при выполнении заданий, научила меня еще и тому, что отправлять лрабораторную и делать к ней отчет надо сразу, а не через два месяца!

### Задание 1

- Задание: *«Товарищ!!! Помоги пилоту бомбардировщика найти демократически умеренных жителей с автоматами при помощи тепловизора. Известно, что они любят прятаться в уютных тёплых домиках (которые заметно теплее всего остального) и там же делать свои тёмные делишки. Чтобы пилоту было удобнее навестись тебе надо обозначить примерный центр цели на изображении». См. картинки в папке «allababah»..*

Реализована функция DetectTargets в файле infrared_camera.cpp. После перевода изображения в черно-белое производится сглаживание с помощью фильтра среднего, чтобы снизить влияние шумов на процесс сегментации, затем производится пороговая обпработка, чтобы выделить участки с наибольшей интенсивностью - цели, затем находится контуры выбранных областей, затем их центры масс, по которым рисуются указатели на цели - крестики.

Пример работы на видео:


https://user-images.githubusercontent.com/90468326/231848798-01fb1bd3-6b09-4479-b28d-c8077f018de7.mp4


### Задание 2

- Задание: *Товарищ! Родина не ждёт! Тебя отправили работать в сверхсекретное КБ, где тебе поручили разработать сверхсекретную систему сверхсекретного наведения на забугорные транспортные средства, которые желают принести нам демократию. Твоя задача - точно навести сверхсекретную пушку на тёпленькое моторное отделение». См. картинки в папке «teplovizor*

Реализована функция DetectEngine. Так как двигатели, которые необходимо обнаруживать, имеют красный цвет, было решено разделить исходное RGB изображение на три канала и рассматривать только красный слой, на котором красные области будут иметь наибольшую интенсивность. Далее алгоритм схож с первым заданием, кроме того, что в конце выбирается самый большой контур, который и отмечается в качестве приоритетной цели.


![Task2](https://user-images.githubusercontent.com/90468326/231850487-d2f06152-1e32-4448-9589-3b5cd5c9853e.jpg)


### Задание 3

- Задание: *«В том же секретном КБ тебе поручили следить за особыми экспериментальными роботами, которые любят погреться под лампочкой. Твоя задача: 
					1)	На каждом роботе найти его цветную верхнюю крышку и обвести контуром цвета его команды;
					2)	Найти лампу, обозначить её как-нибудь.
					3)	Для каждой команды обозначить ближайшего робота к лампе, путём рисования его центра масс.»*

Реализована функция FindRobots в файле robots.cpp. Лампочка находится по наибольшей интенсивности подобно первому заданию. Для разделения роботов по командам исходное изображение переводится в цветовое пространство HSV, и далее производится сегментация в цветовом пространстве при помощи функции inRange по Hue и Saturation согласно первой картинке(Stack Overflow). Затем при помощи морфологических операций отбрасывается красный обод лампы и очевидно ложные вещи, и бинарные изображения уже передаются в функции определения команд, где они обводятся цветом команды. Ближайшие к лампе роботы находятся по наименьшему расстоянию от центра масс контура, задающего лампочку, до ближайших центров масс роботов каждой команды (белый круг). Тем не менее зеленые роботы, которые приближаются слишком близко к лампочке и меняют свой цвет на близкий к фону, могут не детектироваться, и порой обод лампы на один-два кадра отмечается как красный робот.

P.S. Когда загрузил сюда видео, понял, что случайно программа для записи экрана записала музыку, которая играла на фоне.


Поправил детекцию: для наглядности, подряд идут по две фотографии одной и той же сцены. На первой роботы не находятся, на второй находятся.

![Old_1](https://user-images.githubusercontent.com/90468326/232059252-aa858245-cf0c-42de-9fe5-08ce868de047.png)
![New_1](https://user-images.githubusercontent.com/90468326/232059293-91900635-429d-4130-a141-c8ee8c98c153.png)

![Old_2](https://user-images.githubusercontent.com/90468326/232059327-e85bcfe6-4f83-4ca1-bca3-e5e38108aa93.png)
![New_2](https://user-images.githubusercontent.com/90468326/232059356-2ae1ea09-eb86-4eba-b0b6-77204f9927f0.png)

![Old_3](https://user-images.githubusercontent.com/90468326/232059384-47be843f-bfae-4693-aebe-e7122e0629a5.png)
![New_3](https://user-images.githubusercontent.com/90468326/232059409-60924ea9-7a81-4801-b370-6a649ba1a9e6.png)

![Old_4](https://user-images.githubusercontent.com/90468326/232059431-0d9ddfb8-696e-4b37-870c-ba566cbf8255.png)
![New_4](https://user-images.githubusercontent.com/90468326/232059459-fab11d47-42d7-4fd8-8248-f60d4db3dfc7.png)

![Old_5](https://user-images.githubusercontent.com/90468326/232059535-59ea54b7-65cf-430e-8c27-17d75ebd5ca6.png)
![New_5](https://user-images.githubusercontent.com/90468326/232059546-629baff6-de68-460f-9b25-3fe3d6409b16.png)

Старое видео:

https://user-images.githubusercontent.com/90468326/231848077-44fe20cc-24e8-4cf5-82ad-1cabc112f8aa.mp4

Исправленное:


https://user-images.githubusercontent.com/90468326/232060377-fd8127fc-79e8-43cf-b54d-e733cd4dd9b5.mp4



![gyuw4](https://user-images.githubusercontent.com/90468326/232027804-8b246d47-8296-4abc-a58a-910f1066c0b7.png)



### Задание 4

- Задание: *4.	А теперь тебе поручили разработать систему ТЗ по отбраковке гаечных ключей для сборки тех роботов. Обозначь бракованные и правильные гаечные ключи разными метками.  См. картинки в папке «gk».*

Реализована функция ValidateKeys в файле wrench.cpp. Сначала при помощи пороговой сегментации находятся бинарные изображения ключей, определяются их контуры, затем поочередно сравниваются с шабюлоном и разделяются на подходящие и неподходящие в зависимости от степени схожести.


![Task4](https://user-images.githubusercontent.com/90468326/231850880-d7f68ff8-f374-4908-8951-c0a5c7a2dd82.jpg)

Исправленное видео:

