# Лабораторная работа №3

Эта работа научила меня тому, что отчет надо делать сразу по завершении лабораторной, а не через месяц!

### Задание 1

- Задание: *«Товарищ!!! Помоги пилоту бомбардировщика найти демократически умеренных жителей с автоматами при помощи тепловизора. Известно, что они любят прятаться в уютных тёплых домиках (которые заметно теплее всего остального) и там же делать свои тёмные делишки. Чтобы пилоту было удобнее навестись тебе надо обозначить примерный центр цели на изображении». См. картинки в папке «allababah»..*

Реализована функция DetectTargets в файле infrared_camera.cpp. После перевода изображения в черно-белое производится сглаживание с помощью фильтра среднего, чтобы снизить влияние шумов на процесс сегментации, затем производится пороговая обпработка, чтобы выделить участки с наибольшей интенсивностью - цели, затем находится контуры выбранных областей, затем их центры масс, по которым рисуются указатели на цели - крестики.

Пример работы на видео:

![Задание 1, пример](readme_vid/Task1.mp4)


### Задание 2

- Задание: *Товарищ! Родина не ждёт! Тебя отправили работать в сверхсекретное КБ, где тебе поручили разработать сверхсекретную систему сверхсекретного наведения на забугорные транспортные средства, которые желают принести нам демократию. Твоя задача - точно навести сверхсекретную пушку на тёпленькое моторное отделение». См. картинки в папке «teplovizor*

Реализована функция DetectEngine. Так как двигатели, которые необходимо обнаруживать, имеют красный цвет, было решено разделить исходное RGB изображение на три канала и рассматривать только красный слой, на котором красные области будут иметь наибольшую интенсивность. Далее алгоритм схож с первым заданием, кроме того, что в конце выбирается самый большой контур, который и отмечается в качестве приоритетной цели.

На рисунках приведены (слева направо): исходное изображение, магнитуда после собственного быстрого преобразование Фурье, магнитуда после встроенного в OpenCV преобразования.


![Задание 2, пример](readme_img/Task2.jpg)


### Задание 3

- Задание: *«В том же секретном КБ тебе поручили следить за особыми экспериментальными роботами, которые любят погреться под лампочкой. Твоя задача: 
					1)	На каждом роботе найти его цветную верхнюю крышку и обвести контуром цвета его команды;
					2)	Найти лампу, обозначить её как-нибудь.
					3)	Для каждой команды обозначить ближайшего робота к лампе, путём рисования его центра масс.»*

Реализована функция FindRobots в файле robots.cpp. Лампочка находится по наибольшей интенсивности подобно первому заданию. Для разделения роботов по командам исходное изображение переводится в цветовое пространство HSV, и далее производится сегментация в цветовом пространстве при помощи функции inRange по Hue и Saturation согласно первой картинке(Stack Overflow). Затем при помощи морфологических операций отбрасывается красный обод лампы и очевидно ложные вещи, и бинарные изображения уже передаются в функции определения команд, где они обводятся цветом команды. Ближайшие к лампе роботы находятся по наименьшему расстоянию от центра масс контура, задающего лампочку, до ближайших центров масс роботов каждой команды (белый круг). Тем не менее зеленые роботы, которые приближаются слишком близко к лампочке и меняют свой цвет на близкий к фону, могут не детектироваться, и порой обод лампы на один-два кадра отмечается как красный робот.

![Задание 3, пример](readme_vid/Task3.mp4)


### Задание 4

- Задание: *4.	А теперь тебе поручили разработать систему ТЗ по отбраковке гаечных ключей для сборки тех роботов. Обозначь бракованные и правильные гаечные ключи разными метками.  См. картинки в папке «gk».*

Реализована функция ValidateKeys в файле wrench.cpp. Сначала при помощи пороговой сегментации находятся бинарные изображения ключей, определяются их контуры, затем поочередно сравниваются с шабюлоном и разделяются на подходящие и неподходящие в зависимости от степени схожести.

![Задание 4, пример](readme_img/Task4.jpg)